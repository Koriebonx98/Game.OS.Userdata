# Setup Labels
#
# Creates (or updates) all labels referenced in dependabot.yml so that
# Dependabot can apply them when it opens pull requests.
#
# Runs automatically on every push to main and can be triggered manually.

name: Setup Labels

on:
  push:
    branches: [main]
    paths:
      - '.github/dependabot.yml'
      - '.github/workflows/setup-labels.yml'
  workflow_dispatch:

permissions:
  issues: write   # required to create / update labels

jobs:
  create-labels:
    name: Create Required Labels
    runs-on: ubuntu-latest

    steps:
      - name: Create labels
        env:
          GH_TOKEN: ${{ github.token }}
        run: |
          # gh label create exits non-zero if the label already exists,
          # so we use --force to update-or-create idempotently.
          gh label create "dependencies" \
            --repo "${{ github.repository }}" \
            --description "Dependency version bumps (Dependabot)" \
            --color "0075ca" \
            --force

          gh label create "backend" \
            --repo "${{ github.repository }}" \
            --description "Changes to backend Node.js code or dependencies" \
            --color "e4e669" \
            --force

          gh label create "github-actions" \
            --repo "${{ github.repository }}" \
            --description "Changes to GitHub Actions workflows" \
            --color "000000" \
            --force

          echo "âœ… All labels created / updated successfully"
